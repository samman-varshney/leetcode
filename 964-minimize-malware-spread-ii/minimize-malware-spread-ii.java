class Solution {

   HashSet<Integer> infectents;
    public int[] dfs(int node, List<List<Integer>> adj, int[] visited){
        visited[node] = 1;

        int[] res = new int[2];
        res[0] = infectents.contains(node)?1:0;
        res[1] = 1; 

        for(int child: adj.get(node)){
            if(visited[child]==0){
                int[] temp = dfs(child, adj, visited);
                res[0] = Math.max(res[0], temp[0]);
                res[1] += temp[1];
            }
        }

        return res;
    }
    public int minMalwareSpread(int[][] grid, int[] initial) {
        int n = grid.length;
        List<List<Integer>> adj = new ArrayList<>();
        for(int i=0; i<n; i++){
            adj.add(new ArrayList<>());
        }

        for(int i=0; i<n; i++){
            for(int j=0; j<n; j++){
                if(j==i)continue;
                if(grid[i][j]==1){
                    adj.get(i).add(j);
                    adj.get(j).add(i);
                }
            }
        }
        infectents = new HashSet<>();
        for(int x: initial){
            infectents.add(x);
        }

        Arrays.sort(initial);
        int[] visited = new int[n];
        int maxGain = -1, res = -1;
        for(int x: initial){
            Arrays.fill(visited, 0);
            visited[x] = 1;
            int gain = 0;
            for(int child: adj.get(x)){
                if(visited[child]==0){
                    int[] temp = dfs(child, adj, visited);
                    if(temp[0]==0){
                        gain+=temp[1];
                    }
                }
            }

            if(gain > maxGain){
                maxGain = gain;
                res = x;
            }
        }
        return res;
    }
}